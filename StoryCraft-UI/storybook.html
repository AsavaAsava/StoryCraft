<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Fredoka One&family=Open+Sans&family=Roboto:wght@400;500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="storybook.css">
    <link rel="stylesheet" href="testoftest.css">
    <title>Document</title>
</head>

<body>
    <nav class="navbar">
        <ul class="menu-logo">
            <li><a class="logo">StoryCraft</a></li>
        </ul>
        <ul class="menu-items">
            <li><a href="#">Build a story</a></li>
            <li><a href="#"><span class="material-symbols-outlined">account_circle</span></a></li>
            <li><a>
                    <select name="languages" id="lang">
                        <option value="english">English</option>
                        <option value="kiswahili">Swahili</option>
                        <option value="french">French</option>
                    </select>
                </a>
            </li>
        </ul>
    </nav>
    <div class="container">
        <div class="left">
            <div class="book">
                <div class="book-wrap">
                    <div id="cover-front" class="cover cover-front" data-dir="r">
                        <img src="images/book-page/Your story.png" alt="">
                    </div>
                    <div id="cover-back" class="cover cover-back" data-dir="r">
                        <img src="images/book-page/Your story (1).png" alt="">
                    </div>
                    <div class="book-bg">
                        <div class="page-wrap">
                            <div class="page-bg" id="page-container">
                                <!-- <div id="page-1" class="page" data-dir="r">
                                    <div class="page-trigger"></div>
                                    <div class="page-content">
                                        <div class="page-image">
                                            <img src="https://www.indiewire.com/wp-content/uploads/2022/04/The-Bad-Guys-3.jpg"
                                                alt="">
                                        </div>
                                        <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Facilis deserunt
                                            soluta,
                                            minus architecto animi quod. Officia, neque dolores facilis, numquam vel
                                            molestiae
                                            perspiciatis cupiditate iste accusantium vitae fugit aliquam vero.</p>
                                        <div class="page-audio">
                                            <audio controls preload="metadata">
                                                <source src="https://www.w3schools.com/html/horse.ogg" type="audio/ogg">
                                            </audio>
                                        </div>
                                    </div>
                                </div>
                                <div id="page-2" class="page" data-dir="r">
                                    <div class="page-trigger"></div>
                                    <div class="page-content"></div>
                                </div>
                                <div id="page-3" class="page" data-dir="r">
                                    <div class="page-trigger"></div>
                                    <div class="page-content">
                                        <div class="page-image">
                                            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSjWhBbJAPH0b8q7wLUNXTAqpUPwcvyTSoCYA_pZdT3OjeY1d4_DdMkHDcYY3d9PeBxDWA&usqp=CAU"
                                                alt="">
                                        </div>
                                        <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Facilis deserunt
                                            soluta,
                                            minus architecto animi quod. Officia, neque dolores facilis, numquam vel
                                            molestiae
                                            perspiciatis cupiditate iste accusantium vitae fugit aliquam vero.</p>
                                        <div class="page-audio">
                                            <audio controls preload="metadata">
                                                <source src="https://www.w3schools.com/html/horse.ogg" type="audio/ogg">
                                            </audio>
                                        </div>
                                    </div>
                                </div>
                                <div id="page-4" class="page" data-dir="r">
                                    <div class="page-trigger"></div>
                                    <div class="page-content"></div>
                                </div>
                                <div id="page-5" class="page" data-dir="r">
                                    <div class="page-trigger"></div>
                                    <div class="page-content">
                                        <div class="page-image">
                                            <img src="https://cdn.whats-on-netflix.com/wp-content/uploads/2023/06/02192554/orion-and-the-dark-netflix-movie-dreamworks-jpg.webp"
                                                alt="">
                                        </div>
                                        <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Facilis deserunt
                                            soluta,
                                            minus architecto animi quod. Officia, neque dolores facilis, numquam vel
                                            molestiae
                                            perspiciatis cupiditate iste accusantium vitae fugit aliquam vero.</p>
                                        <div class="page-audio">
                                            <audio controls preload="metadata">
                                                <source src="https://www.w3schools.com/html/horse.ogg" type="audio/ogg">
                                            </audio>
                                        </div>
                                    </div>
                                </div>
                                <div id="page-6" class="page" data-dir="r">
                                    <div class="page-trigger"></div>
                                    <div class="page-content"></div>
                                </div>
                                <div id="page-7" class="page" data-dir="r">
                                    <div class="page-trigger"></div>
                                    <div class="page-content">
                                        <div class="page-image">
                                            <img src="https://beforesandafters.com/wp-content/uploads/2023/01/sq210_s160_f109_4_final.jpg"
                                                alt="">
                                        </div>
                                        <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Facilis deserunt
                                            soluta,
                                            minus architecto animi quod. Officia, neque dolores facilis, numquam vel
                                            molestiae
                                            perspiciatis cupiditate iste accusantium vitae fugit aliquam vero.</p>
                                        <div class="page-audio">
                                            <audio controls preload="metadata">
                                                <source src="https://www.w3schools.com/html/horse.ogg" type="audio/ogg">
                                            </audio>
                                        </div>
                                    </div>
                                </div>
                                <div id="page-8" class="page" data-dir="r">
                                    <div class="page-trigger"></div>
                                    <div class="page-content"></div>
                                </div> -->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="action-buttons">
                    <button class="btn-download">
                        <span class="tooltip">Download</span>
                        <span class="material-symbols-outlined">
                            download
                        </span></button>
                    <button class="btn-share">
                        <span class="tooltip">Share</span>
                        <span class="material-symbols-outlined">
                            share
                        </span></button>
                    <button class="btn-regen">
                        <span class="tooltip">Refresh</span>
                        <span class="material-symbols-outlined">
                            refresh
                        </span></button>
                </div>
            </div>
            <div class="next-steps">
                <h2>What next</h2>
                <div class="next-top">
                    <h3>Someone / Somewhere new . . .</h3>
                    <div class="card-top-right"></div>
                    <div class="card-bottom-left"></div>
                    <div class="options">
                        <div class="option active"
                            style="--optionBackground:url(https://media.cnn.com/api/v1/images/stellar/prod/230824092430-03-winnie-the-pooh-sketch-disney-restricted.jpg?c=original&q=w_1280,c_fill);">
                            <div class="shadow"></div>
                            <div class="label">
                                <div class="icon">
                                    <p>1</p>
                                </div>
                                <div class="info">
                                    <div class="main">
                                        <p>You meet Winnie the Pooh and his old friends</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="option"
                            style="--optionBackground:url(https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS7enmUQO9m3bA0Y2_fvei9RL71CMyMoGkZRjxcK8qdH8ZY9jAHbplhnddoN1yCw4xpB-M&usqp=CAU);">
                            <div class="shadow"></div>
                            <div class="label">
                                <div class="icon">
                                    <p>2</p>
                                </div>
                                <div class="info">
                                    <div class="main">
                                        <p>Spiderman flies by your school</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="option"
                            style="--optionBackground:url(https://facts.net/wp-content/uploads/2023/09/16-facts-about-princess-anna-frozen-1693809476.jpg);">
                            <div class="shadow"></div>
                            <div class="label">
                                <div class="icon">
                                    <p>3</p>
                                </div>
                                <div class="info">
                                    <div class="main">
                                        <p>You come across Anna hiding in the forest</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="next-bottom">
                    <h3>Something unexpected . . .</h3>
                    <div class="card-top-right"></div>
                    <div class="card-bottom-left"></div>
                    <div class="options">
                        <div class="option-bottom active"
                            style="--optionBackground:url(https://cf-images.us-east-1.prod.boltdns.net/v1/static/5359769168001/b74b48f9-6c13-452e-8776-ea1ab9074953/74b9774e-a415-4499-8f1a-26e5e0940ecd/1280x720/match/image.jpg);">
                            <div class="shadow"></div>
                            <div class="label">
                                <div class="icon">
                                    <p>1</p>
                                </div>
                                <div class="info">
                                    <div class="main">
                                        <p>Spiderman's spidey sense goes off!!!</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="option-bottom"
                            style="--optionBackground:url(https://st.depositphotos.com/1732591/3939/v/450/depositphotos_39399025-stock-illustration-hand-knocking-on-doors.jpg);">
                            <div class="shadow"></div>
                            <div class="label">
                                <div class="icon">
                                    <p>2</p>
                                </div>
                                <div class="info">
                                    <div class="main">
                                        <p>Who might that be?</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script>
            let story = JSON.parse(localStorage.getItem("story"));
            let pageImages = story.images;
            let paragraphs = story.parts;

            let pageCount = story.images.length;

            for (let i = 0; i < pageCount; i++) {
                var pageDiv = document.getElementById("page-container");
                pageDiv.innerHTML += `<div id="page-${(i*2)-1}" class="page" data-dir="r">
                                    <div class="page-trigger"></div>
                                    <div class="page-content">
                                        <div class="page-image">
                                            <img src="${pageImages[i]}"
                                                alt="Page Image">
                                        </div>
                                        <p>${paragraphs[i]}</p>
                                        <div class="page-audio">
                                            <audio controls preload="metadata">
                                                <source src="https://www.w3schools.com/html/horse.ogg" type="audio/ogg">
                                            </audio>
                                        </div>
                                    </div>
                                </div>
                                <div id="page-${(i*2)}" class="page" data-dir="r">
                                    <div class="page-trigger"></div>
                                    <div class="page-content"></div>
                                </div>`;
            }

            var coverIndex = 1;
            var pageIndex = 0
            var num = $('.page').length;
            var zIndexSet = '<style>';

            for (i = 1; i <= num; i++) {
                zIndexSet += '[data-dir="r"]#page-' + i + '{z-index: ' + (num - i + 1) + '}';
            };
            zIndexSet += '</style>';
            $('.book').prepend(zIndexSet);
            $(function () {
                $('.page-trigger').on('click', function () {
                    var e = $(this).parent('.page')
                    flip(e.attr('id'), e)
                });


                $('.cover').on('click', function () {
                    var e = $(this)
                    flip(e.attr('id'), e)
                });

            });

            function flip(type, $page) {
                var isEnabled = true

                if (isEnabled) {
                    isEnabled = false;

                    if (type.indexOf('cover') != -1) {
                        coverIndex += 1

                        setTimeout(function () {
                            $('.book-bg').css('z-index', '2')
                        }, 800);
                    }



                    if ($page.attr('data-dir') == "r") {
                        $page.attr('data-dir', 'l').css('transform', 'rotateY(-180deg)');
                        $page.next().attr('data-dir', 'l').css('transform', 'rotateY(0deg)');
                        if (type == 'page') { pageIndex += 2 }
                        if (type == 'cover') { coverIndex += 1 }
                        console.log('pageIndex ' + pageIndex + ' coverIndex ' + coverIndex);
                        setTimeout(function () {
                            isEnabled = true
                        }, 800);
                    } else if ($page.attr('data-dir') == "l") {
                        // debugger
                        $page.attr('data-dir', 'r').css('transform', 'rotateY(180deg)');
                        $page.prev().attr('data-dir', 'r').css('transform', 'rotateY(0deg)');
                        if (type == 'page') { pageIndex -= 2 }
                        if (type == 'cover') { coverIndex -= 1 }
                        console.log('pageIndex ' + pageIndex + ' coverIndex ' + coverIndex);
                        setTimeout(function () {
                            isEnabled = true
                        }, 800);

                    };

                };

            }

            $(".option").click(function () {
                $(".option").removeClass("active");
                $(this).addClass("active");
            });

            $(".option-bottom").click(function () {
                $(".option-bottom").removeClass("active");
                $(this).addClass("active");
            });
        </script>
</body>

</html>